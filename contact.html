<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تماس با من</title>
    <link rel="stylesheet" href="style.css">
    
</head>
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<body>
    <header>
        <nav class="nav-menu">
            <a href="index.html">خانه</a>
            <a href="index.html#about">درباره من</a>
            <a href="index.html#skills">مهارت ها</a>
            <a href="contact.html" class="active">تماس با من</a>
        </nav>
    </header>
    <section class="contact">
        <h2>تماس با من</h2>
        <form id="contactForm" class="contact-form">
            <input type="text" id="name" placeholder="نام شما">
            <input type="email" id="email" placeholder="ایمیل">
            <textarea id="message" placeholder="پیام شما"></textarea>
            <button type="button" id="sendBtn" class="btn-primary">ارسال پیام</button>
        </form>

        <p id="formStatus" class="status-message"></p>

    </section>
    <footer class="footer">
        <p>حسین احمدوند -تمامی حقوق محفوظ است 2024</p>
    </footer>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const btn = document.getElementById("sendBtn");
            const statusMsg = document.getElementById("formStatus");

            btn.addEventListener("click", async (e) => {
                e.preventDefault();

                const name = document.getElementById("name").value.trim();
                const email = document.getElementById("email").value.trim();
                const message = document.getElementById("message").value.trim();

                if (!name || !email || !message) {
                    statusMsg.style.color = "red";
                    statusMsg.textContent = "لطفا تمام فیلدها را پر کنید!";
                    return;
                }

                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPattern.test(email)) {
                    statusMsg.style.color = "red";
                    statusMsg.textContent = "ایمیل معتبر وارد کنید!";
                    return;
                }

                try {
                    const res = await fetch("http://localhost:3000/api/contact", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            fullname: name,
                            email,
                            message
                        }),
                    });

                    const data = await res.json();

                    if (data.success) {
                        statusMsg.style.color = "green";
                        statusMsg.textContent = "پیام ذخیره شد ✔️";
                        document.getElementById("contactForm").reset();
                    } else {
                        statusMsg.style.color = "red";
                        statusMsg.textContent = "خطا در ذخیره پیام";
                    }

                } catch (err) {
                    statusMsg.style.color = "red";
                    statusMsg.textContent = "ارتباط با سرور برقرار نشد!";
                    console.error(err);
                }
            });
        });
    </script>
</body>

</html>